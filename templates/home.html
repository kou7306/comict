
{% extends "base.html" %} {% block extra_css %} 
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
<link rel="stylesheet" href="https://unpkg.com/@sjmc11/tourguidejs/dist/css/tour.min.css">

{% endblock %} {% block content%}


{% if logged_in %}


  <div class="mx-20">
      <section class="w-full my-8">
          <h2 class="mb-8 text-3xl">あなたにおすすめの漫画</h2>
          
          <div data-tg-order='1' data-tg-tour='あなたのアンケートをもとにマッチングされた漫画です。' class="swiper mySwiper">
              <div class="swiper-wrapper">
                {% if data != [] %}
                  {% for title, url in data %}
                  {% if url != "no" %}
                  <div class="swiper-slide bg-center bg-cover">
                      <a href="/{{ title }}/detail" >
                          <img class="block w-full h-full" src="{{ url }}" alt="">
                      </a>
                  </div>
                  {% else %}
                  <div class="swiper-slide">
                    <a href="/{{ title }}/detail">
                        <img class="image-placeholder" src="https://illustrain.com/img/work/2016/illustrain08-book02.png" alt="">
                    </a>
                  </div>             
                  {% endif %}
                  {% endfor %}
                  {% endif %}
      
                  {% if favolite_book_urls !=[] %}
                  {% for url in favolite_book_urls %}
                  <div class="swiper-slide">
                    <img class="image-placeholder" src="{{ url }}" alt="">
                  </div>
                  
                  
                  {% endfor %}
                  {% endif %}
                  
              </div>
              <div class="swiper-button-prev"></div>
              <div class="swiper-button-next"></div>
          </div>
        </section>


    

    <section class="my-20" id="user">
        <h2 class="text-3xl">あなたの属性に近いユーザー</h2>
        <ul data-tg-order='2' data-tg-tour='あなたのアンケートの回答と似ているユーザーです。' class="flex flex-wrap list-none">
          {% if user_query != None %}
          {% for id in user_query %}
          {% if user_doc_ref.document(id).get().to_dict()["username"] != username %}
          <li class="w-2/12 text-center box-border m-2">

            <img src="https://kotonohaworks.com/free-icons/wp-content/uploads/kkrn_icon_user_1.png">
            <div>
              <a href="/{{id}}/userpage" class="text-white hover:text-blue-500">{{user_doc_ref.document(id).get().to_dict()["username"]}}</a>


          </div>    
          </li>
      
        {% endif %}
          {% endfor %}
          {% endif %}
        
      </ul>
    </section>

    <section class="my-20" id="reviewer">
        <h2 class="text-3xl" >フォローしたユーザー</h2>
        <ul class="flex flex-wrap list-none">
          
          {% for follow in follow_data %}
          <li class="w-2/12 text-center box-border m-2">
          <img src="https://kotonohaworks.com/free-icons/wp-content/uploads/kkrn_icon_user_1.png">
          <div>
            <a href="/{{follow[1]}}/userpage" class="hover:text-blue-500">{{follow[0]}}</a>
            
          </div>    
        </li>
          {% endfor %}
   
      </ul>
    </section>
{% endif %}
    <section class="w-full my-8">
      <h2 class="mb-8 text-3xl">レビュー数の多い漫画</h2>
      
      <div class="swiper mySwiper">
          <div class="swiper-wrapper">


              {% if all_review_book_urls !=[] %}
              {% for url in all_review_book_urls %}
              <div class="swiper-slide">
                <img class="image-placeholder" src="{{ url }}" alt="">
              </div>
              
              
              {% endfor %}
              {% endif %}
          </div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-button-next"></div>
      </div>
    </section>

    <section class="w-full my-8">
      <h2 class="mb-8 text-3xl">レビュー数の多い（一週間以内）漫画</h2>
      
      <div class="swiper mySwiper">
          <div class="swiper-wrapper">


              {% if week_review_book_urls !=[] %}
              {% for url in week_review_book_urls %}
              <div class="swiper-slide">
                <img class="image-placeholder" src="{{ url }}" alt="">
              </div>
              
              
              {% endfor %}
              {% endif %}
          </div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-button-next"></div>
      </div>
    </section>


    <section class="w-full my-8">
      <h2 class="mb-8 text-3xl">ブックマーク数が多い漫画</h2>
      
      <div class="swiper mySwiper">
          <div class="swiper-wrapper">


              {% if bookmark_book_urls !=[] %}
              {% for url in bookmark_book_urls %}
              <div class="swiper-slide">
                <img class="image-placeholder" src="{{ url }}" alt="">
              </div>
              
              
              {% endfor %}
              {% endif %}
          </div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-button-next"></div>
      </div>
    </section>


    <section class="w-full my-8">
      <h2 class="mb-8 text-3xl">高評価の漫画</h2>
      
      <div class="swiper mySwiper">
          <div class="swiper-wrapper">


              {% if high_evaluate_book_urls !=[] %}
              {% for url in high_evaluate_book_urls %}
              <div class="swiper-slide">
                <img class="image-placeholder" src="{{ url }}" alt="">
              </div>
              
              
              {% endfor %}
              {% endif %}
          </div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-button-next"></div>
      </div>
    </section>

    <section id="timeline">
        <h2 class="text-3xl">タイムライン</h2>
        <ul>
          {% for review in review_doc_ref.stream() %}

          
          <a href="/review_detail?review_id={{review.id}}" class="block hover:scale-105">
          <li class="my-4 mx-8 p-4 bg-gray-800">
            <p>
              タイトル：{{review.to_dict()["mangaTitle"]}}
            </p>
            <p>{{user_doc_ref.document(review.to_dict()["user_id"]).get().to_dict()["username"]}}</p>

            <p>評価：{{review.to_dict()["evaluation"]}}</p>
            <p style="word-wrap: break-word;">{{review.to_dict()["contents"][:100]}}</p>
          </li>
        </a>
          {% endfor %}
      </ul>
    </section>
  </div>

    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="../static/javascript/home.js"></script>
    <script src="https://unpkg.com/@sjmc11/tourguidejs/dist/tour.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>

    </script>
{% endblock %}

