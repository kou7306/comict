
{% extends "base.html" %} {% block extra_css %} 
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
<link rel="stylesheet" href="https://unpkg.com/@sjmc11/tourguidejs/dist/css/tour.min.css">
{% endblock %} {% block content%}




  <div class="mx-20">
    <section class="w-full my-8">
      <h2 class="mb-8 text-3xl">あなたにおすすめの漫画</h2>
      
      <div data-tg-order='1' data-tg-tour='あなたのアンケートをもとにマッチングされた漫画です。' class="swiper mySwiper">
          <div class="swiper-wrapper">
            {% if data != [] %}
              {% for title, url in data %}
              {% if url != "no" %}
              <div class="swiper-slide bg-center bg-cover">
                  <a href="/{{ user_id }}/{{ title }}/detail">
                      <img class="block w-full h-full" src="{{ url }}" alt="">
                  </a>
              </div>
              {% else %}
              <div class="swiper-slide">
                <a href="/{{ user_id }}/{{ title }}/detail">
                    <img class="image-placeholder" src="https://illustrain.com/img/work/2016/illustrain08-book02.png" alt="">
                </a>
              </div>             
              {% endif %}
              {% endfor %}
              {% endif %}

              {% if favolite_book_urls !=[] %}
              {% for url in favolite_book_urls %}
              <div class="swiper-slide">
                <img class="image-placeholder" src="{{ url }}" alt="">
              </div>
              
              
              {% endfor %}
              {% endif %}
          </div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-button-next"></div>
      </div>
    </section>

    

    <section class="my-20" id="user">
        <h2 class="text-3xl">あなたの属性に近いユーザー</h2>
        <ul data-tg-order='2' data-tg-tour='あなたのアンケートの回答と似ているユーザーです。' class="flex flex-wrap list-none">
          {% if user_query != None %}
          {% for id in user_query %}
          {% if user_doc_ref.document(id).get().to_dict()["username"] != username %}
          <li class="w-2/12 text-center box-border m-2">

            <img src="https://kotonohaworks.com/free-icons/wp-content/uploads/kkrn_icon_user_1.png">
            <div>
              <a href="/{{user_id}}/{{id}}/userpage"><h3>{{user_doc_ref.document(id).get().to_dict()["username"]}}</h3></a>


          </div>    
          </li>
      
        {% endif %}
          {% endfor %}
          {% endif %}
        
      </ul>
    </section>

    <section class="my-20" id="reviewer">
        <h2 class="text-3xl" >フォローしたユーザー</h2>
        <ul class="flex flex-wrap list-none">
          
          {% for follow in follow_data %}
          <li class="w-2/12 text-center box-border m-2">
          <img src="https://kotonohaworks.com/free-icons/wp-content/uploads/kkrn_icon_user_1.png">
          <div>
            <a href="/{{user_id}}/{{follow[1]}}/userpage"><h3>{{follow[0]}}</h3></a>
            
          </div>    
        </li>
          {% endfor %}
   
      </ul>
    </section>

    <section id="timeline">
        <h2 class="text-3xl">タイムライン</h2>
        <ul>
          {% for review in review_doc_ref.stream() %}
          
          <li class="my-4 p-4 bg-gray-800">
            <p>{{review.to_dict()["username"]}}</p>
            <a href="/{{ user_id }}/{{review.to_dict()['mangaTitle']}}/detail">
              <p>タイトル：{{review.to_dict()["mangaTitle"]}}</p>
            </a>
            <p>評価：{{review.to_dict()["evaluation"]}}</p>
            <p>{{review.to_dict()["contents"]}}</p>
          </li>
          
          {% endfor %}
      </ul>
    </section>
  </div>

    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="../static/javascript/home.js"></script>
    <script src="https://unpkg.com/@sjmc11/tourguidejs/dist/tour.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
//       document.addEventListener("DOMContentLoaded", function() {
//         if ({{ show_intro | tojson }}) {
//         introJs().start();
//     }
//  });
  if ({{ show_intro | tojson }}) {
    const tg = new tourguide.TourGuideClient();

    tg.start();
  }
    </script>
{% endblock %}

